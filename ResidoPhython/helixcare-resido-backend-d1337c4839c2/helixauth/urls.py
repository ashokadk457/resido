from django.urls import re_path
from .apiviews import (
    ActivateUsers,
    ChangePassword,
    LoginView,
    LogoutView,
    PoliciesCountAPIView,
    ResetPassword,
    ConfirmResetPassword,
    CustomTokenRefreshView,
    SecurityQuestionView,
    ValidateSecurityQuestionAndLogin,
    UserRoleView,
    ActivateUser,
    CreateTenantAdmin,
    HelixUserListCreateView,
    HelixUserDetail,
    ModulePermissionListView,
    ModulePermissionRetrieveUpdateView,
    ModuleListView,
    ModuleRetrieveUpdateView,
    UserRoleListCreateView,
    UserRoleRetrieveUpdateView,
    ModuleCompositionListView,
    ModuleCompositionRetrieveView,
    RegisteredDevicesAPIView,
    AccessLogAPIView,
    LogoutRegisteredDevicesAPIView,
    OtpAPIView,
    ValidateOTPAndLogin,
    ActivateUserViaOTP,
    ResetPasswordLink,
    UserUnlockAPIView,
    TemporaryPasswordView,
    UserGroupListCreateView,
    UserGroupGetUpdateView,
    SubmodulePermissionGetUpdateView,
    SubmodulePermissionListView,
    EntityAttributePermissionListView,
    EntityAttributePermissionGetUpdateView,
    TestAuthenticateAPIView,
    UserRoleModulePermissionGetUpdateView,
    UserRoleEntityPermissionGetUpdateView,
    UserRoleModulePermissionView,
    UserRoleSubModulePermissionView,
    CareCenterRole,
    UserRoleCountView,
    UserResetPasswordAPIView,
    PolicyGetUpdateAPIView,
    PolicyListCreateAPIView,
    UserAcceptanceListCreateAPIView,
)

urlpatterns = [
    re_path(r"^api/v1/login$", LoginView.as_view(), name="login"),
    re_path(
        r"^api/v1/test-authentication$",
        TestAuthenticateAPIView.as_view(),
        name="test_authenticate",
    ),
    re_path(
        r"^api/v1/token/refresh$",
        CustomTokenRefreshView.as_view(),
        name="token_refresh",
    ),
    re_path(r"^api/v1/logout$", LogoutView.as_view(), name="logout_api"),
    # path('api/v1/oauth', include('oauth2_provider.urls', namespace='oauth2_provider')),
    re_path(
        r"^api/v1/password/change$", ChangePassword.as_view(), name="change_password"
    ),
    re_path(r"^api/v1/password/reset$", ResetPassword.as_view(), name="reset_password"),
    re_path(
        r"^api/v1/password/temporary$",
        TemporaryPasswordView.as_view(),
        name="temp_password",
    ),
    re_path(
        r"^api/v1/password/reset-link$",
        ResetPasswordLink.as_view(),
        name="reset_password_link",
    ),
    re_path(
        r"^api/v1/password/reset/confirm$",
        ConfirmResetPassword.as_view(),
        name="reset_password",
    ),
    # re_path(r'^api/v1/authenticate$', AuthenticateAPIView.as_view(), name='login_otp'),
    re_path(
        r"^api/v1/validate-login-otp$",
        ValidateOTPAndLogin.as_view(),
        name="validate_otp",
    ),
    re_path(
        r"^api/v1/verify-otp$",
        ActivateUserViaOTP.as_view(),
        name="activate_user_otp",
    ),
    re_path(
        r"^api/v1/security-questions$",
        SecurityQuestionView.as_view(),
        name="security_questions",
    ),
    re_path(
        r"^api/v1/validate-security-questions$",
        ValidateSecurityQuestionAndLogin.as_view(),
        name="validate_security_question",
    ),
    re_path(r"^api/v1/activate-user$", ActivateUser.as_view(), name="activate_user"),
    re_path(
        r"^api/v1/tenant-admin$",
        CreateTenantAdmin.as_view(),
        name="create_tenant_admin",
    ),
    re_path(r"^api/v1/users$", HelixUserListCreateView.as_view(), name="user_list"),
    re_path(
        r"^api/v1/users/roles-permissions$",
        UserRoleModulePermissionView.as_view(),
        name="user_module_permissions",
    ),
    re_path(
        r"^api/v1/users/roles-permissions/(?P<module_id>[0-9a-zA-Z\-]+)$",
        UserRoleSubModulePermissionView.as_view(),
        name="user_submodule_permissions",
    ),
    re_path(
        r"^api/v1/users/(?P<pk>[0-9a-zA-Z\-]+)$",
        HelixUserDetail.as_view(),
        name="user_details",
    ),
    re_path(
        r"^api/v1/users/(?P<pk>[0-9a-zA-Z\-]+)/role$",
        UserRoleView.as_view(),
        name="user_role",
    ),
    re_path(r"^api/v1/roles$", UserRoleListCreateView.as_view(), name="user_roles"),
    re_path(
        r"^api/v1/roles/(?P<pk>[0-9a-zA-Z\-]+)$",
        UserRoleRetrieveUpdateView.as_view(),
        name="user_role_detail",
    ),
    re_path(
        r"^api/v1/roles/(?P<role_id>[0-9a-zA-Z\-]+)/permissions/(?P<pk>[0-9a-zA-Z\-]+)$",
        UserRoleModulePermissionGetUpdateView.as_view(),
        name="user_role_permission_detail",
    ),
    re_path(
        r"^api/v1/roles/(?P<role_id>[0-9a-zA-Z\-]+)/entities/(?P<pk>[0-9a-zA-Z\-]+)$",
        UserRoleEntityPermissionGetUpdateView.as_view(),
        name="user_role_entity_detail",
    ),
    re_path(
        r"^api/v1/role-count$",
        UserRoleCountView.as_view(),
        name="user_role_count",
    ),
    re_path(
        r"^api/v1/role-groups$",
        UserGroupListCreateView.as_view(),
        name="user_roles_groups",
    ),
    re_path(
        r"^api/v1/role-groups/(?P<pk>[0-9a-zA-Z\-]+)$",
        UserGroupGetUpdateView.as_view(),
        name="user_roles_groups_detail",
    ),
    re_path(r"^api/v1/modules$", ModuleListView.as_view(), name="modules"),
    re_path(
        r"^api/v1/modules/(?P<pk>[0-9a-zA-Z\-]+)$",
        ModuleRetrieveUpdateView.as_view(),
        name="module_detail",
    ),
    re_path(
        r"^api/v1/module-compositions$",
        ModuleCompositionListView.as_view(),
        name="module_composition",
    ),
    re_path(
        r"^api/v1/module-compositions/(?P<pk>[0-9a-zA-Z\-]+)$",
        ModuleCompositionRetrieveView.as_view(),
        name="module_composition_detail",
    ),
    re_path(
        r"^api/v1/module-permissions$",
        ModulePermissionListView.as_view(),
        name="module_permission_list",
    ),
    re_path(
        r"^api/v1/module-permissions/(?P<pk>[0-9a-zA-Z\-]+)$",
        ModulePermissionRetrieveUpdateView.as_view(),
        name="module_permission_detail",
    ),
    re_path(
        r"^api/v1/submodule-permissions$",
        SubmodulePermissionListView.as_view(),
        name="submodule_permission_list",
    ),
    re_path(
        r"^api/v1/submodule-permissions/(?P<pk>[0-9a-zA-Z\-]+)$",
        SubmodulePermissionGetUpdateView.as_view(),
        name="submodule_permission_detail",
    ),
    re_path(
        r"^api/v1/attribute-permissions$",
        EntityAttributePermissionListView.as_view(),
        name="entity_attr_permission_list",
    ),
    re_path(
        r"^api/v1/attribute-permissions/(?P<pk>[0-9a-zA-Z\-]+)$",
        EntityAttributePermissionGetUpdateView.as_view(),
        name="entity_attr_permission_detail",
    ),
    re_path(
        r"^api/v1/users/(?P<pk>[0-9a-zA-Z\-]+)/registered-devices$",
        RegisteredDevicesAPIView.as_view(),
        name="registered_device_list",
    ),
    re_path(
        r"^api/v1/users/(?P<pk>[0-9a-zA-Z\-]+)/access-logs$",
        AccessLogAPIView.as_view(),
        name="access_logs_list",
    ),
    re_path(
        r"^api/v1/users/(?P<pk>[0-9a-zA-Z\-]+)/logout-device$",
        LogoutRegisteredDevicesAPIView.as_view(),
        name="logout_registered_device",
    ),
    # Universal device tracking - extract user from token (works for ANY user type)
    re_path(
        r"^api/v1/registered-devices$",
        RegisteredDevicesAPIView.as_view(),
        name="current_user_registered_devices",
    ),
    re_path(
        r"^api/v1/access-logs$",
        AccessLogAPIView.as_view(),
        name="current_user_access_logs",
    ),
    re_path(
        r"^api/v1/logout-device$",
        LogoutRegisteredDevicesAPIView.as_view(),
        name="current_user_logout_device",
    ),
    re_path(
        r"^api/v1/otp$",
        OtpAPIView.as_view(),
        name="otp_api_view",
    ),
    re_path(
        r"^api/v1/care-center-roles$",
        CareCenterRole.as_view(),
        name="care_center_role_api_view",
    ),
    re_path(
        r"^api/v1/user/reset-password$",
        UserResetPasswordAPIView.as_view(),
        name="user_reset_password",
    ),
    re_path(
        r"^api/v1/policies-count$",
        PoliciesCountAPIView.as_view(),
        name="policies_count",
    ),
    re_path(
        r"^api/v1/policies$",
        PolicyListCreateAPIView.as_view(),
        name="policies",
    ),
    re_path(
        r"^api/v1/policies/(?P<pk>[0-9a-zA-Z\-]+)$",
        PolicyGetUpdateAPIView.as_view(),
        name="policies_detail",
    ),
    re_path(
        r"^api/v1/policy-acceptance$",
        UserAcceptanceListCreateAPIView.as_view(),
        name="user_policy_acceptance",
    ),
    re_path(
        r"^api/v1/user-policy-acceptance$",  # backup url
        UserAcceptanceListCreateAPIView.as_view(),
        name="user_policy_acceptance",
    ),
    re_path(
        r"^api/v1/users-activations$",
        ActivateUsers.as_view(),
        name="user_activate_action",
    ),
    re_path(
        r"^api/v1/users-unlock$",
        UserUnlockAPIView.as_view(),
        name="user_unlock",
    ),
]
